####
# VIEW
# Sala
####
title: Sala
path: living
background: "var(--background-view-living)"

type: custom:vertical-layout
layout:
  card_margin: 8px 0px
  margin: 0px
  max_width: 350
cards:
  - type: "custom:gap-card"
    height: 15

  - type: "custom:layout-card"
    layout_type: "custom:grid-layout"
    layout:
      grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr
      grid-template-rows: auto
      margin: 0px
    cards:
      - type: "custom:decluttering-card"
        template: section-header
        view_layout:
          grid-column: span 6
        variables:
          - name: "Sala de estar"
          - script: script.turn_off_living_room
          - sensor_entity: sensor.lights_on_living_room

      - type: custom:auto-entities
        view_layout:
          grid-column: span 6
        show_empty: false
        filter:
          include:
            - entity_id: "sensor.environment_1_humidity"
              state: ">80.0"
        card:
          type: markdown
          card_mod:
            style: !include ../styles/style-card-alert.yaml
          content: Humidade muito elevada.

      - type: conditional
        view_layout:
          grid-column: span 6
        conditions:
          - entity: climate.sala
            state_not: "off"
        card:
          template: timer-ac
          type: "custom:decluttering-card"
          variables:
            - template: ac
            - entity: timer.ac_living_room
            - entity-ac: climate.sala
            - name: "A/C a funcionar"

      - !include ../views_items/living_room/light.led_strip_living_room.yaml

      - !include ../views_items/living_room/light.light_2.yaml

      - !include ../views_items/living_room/light.luz_corredor.yaml

      - type: custom:mod-card
        view_layout:
          grid-column: span 2
        card_mod:
          style:
            layout-card $ grid-layout $: "#root { --masonry-view-card-margin: 3.3px 0; align-items: center;}"
        card:
          type: "custom:layout-card"
          layout_type: "custom:grid-layout"
          layout:
            card_margin: 0px
            grid-template-columns: 1fr
            grid-template-rows: 1fr 1fr 1fr
            height: 100%
            margin: 0
            padding: 0
          cards:
            - template: sensor-pill
              type: "custom:decluttering-card"
              variables:
                - entity: binary_sensor.athom_presence_sensor_1_occupancy
                - state-1: "on"
                - state-2: "off"
                - icon: mdi:motion-sensor
                - color-state-on: --ha-card-color-name-on
            - template: sensor-pill
              type: "custom:decluttering-card"
              variables:
                - entity: sensor.environment_1_temperature
                - icon: mdi:thermometer
            - template: sensor-pill
              type: "custom:decluttering-card"
              variables:
                - entity: sensor.environment_1_humidity
                - icon: mdi:water-percent
                - numeric_precision: 0

      - template: es-tv
        view_layout:
          grid-column: span 2
        type: "custom:decluttering-card"
        variables:
          - template: tv
          - entity: remote.tv
          - name: "Samsung TV"

      - template: es-ping
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 2
        variables:
          - template: sensor-xbox
          - entity: binary_sensor.xbox_one_x_state
          - name: XBOX

      - template: climate-ac
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 2
        variables:
          - template: ac
          - entity: climate.sala
          - name: A/C

      - template: es-switch-confirmation
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 2
        variables:
          - template: switch
          - entity: switch.askvader_switch
          - name: Vynil
          - confirmation-text: "De certeza? Confirma que o Vynil não está a funcionar se estiveres a desligar a tomada."

      - template: es-cover
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 2
        variables:
          - template: shutter
          - toggle-script: script.toggle_cover_living_room
          - entity: cover.estores_sala
          - name: Estores

      - template: es-light
        view_layout:
          grid-column: span 2
        type: "custom:decluttering-card"
        variables:
          - template: light-strip
          - entity: light.ulanzi_click_matrix
          - name: "Relógio Matrix"
          - info-attribute: states['light.ulanzi_click_matrix'].attributes.brightness

      - type: custom:mod-card
        view_layout:
          grid-column: span 2
        card_mod:
          style:
            layout-card $ grid-layout $: "#root { --masonry-view-card-margin: 3.3px 0; align-items: center;}"
        card:
          type: "custom:layout-card"
          view_layout:
            grid-column: span 2
          layout_type: "custom:grid-layout"
          layout:
            card_margin: 0px
            grid-template-columns: 1fr
            grid-template-rows: 1fr 1fr 1fr
            height: 100%
            margin: 0
            padding: 0
          cards:
            - template: sensor-pill
              type: "custom:decluttering-card"
              variables:
                - entity: sensor.water_sensor
                - icon: mdi:toilet
                - state-1: "ALERTA"
                - state-2: "OK"
                - show-name: true
                - name: Social
            - template: sensor-pill
              type: "custom:decluttering-card"
              variables:
                - entity: sensor.water_sensor_2
                - icon: mdi:toilet
                - state-1: "ALERTA"
                - state-2: "OK"
                - show-name: true
                - name: Grande
            - type: "custom:gap-card"
              height: 10

      - type: custom:mod-card
        view_layout:
          grid-column: span 2
        card_mod:
          style:
            layout-card $ grid-layout $: "#root { --masonry-view-card-margin: 3.3px 0; align-items: center;}"
        card:
          type: "custom:layout-card"
          view_layout:
            grid-column: span 1
          layout_type: "custom:grid-layout"
          layout:
            card_margin: 0px
            grid-template-columns: 1fr
            grid-template-rows: 1fr 1fr
            height: 100%
            margin: 0
            padding: 0
          cards:
            - template: script-sensor
              type: "custom:decluttering-card"
              variables:
                - template: shutter
                - entity: binary_sensor.estores_sala_breeze_mode
                - script: script.set_cover_sala_breeze
                - name: Ventilação
                - state-1: "on"
                - state-2: "off"

      # After christmas, comment ligth code and change back shutters card to one half in ui-lovelace.yaml
      # - !include ../views_items/living_room/light.wled_xmas.yaml

      - template: subsubtitle
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 6
        variables:
          - content: Scenes

      # Final section of scenes
      - template: scene
        type: "custom:decluttering-card"
        view_layout:
          grid-column: span 3
        variables:
          - template: scene-movie
          - scene: scene.movie_time
          - entity: scene.movie_time

      - type: "custom:gap-card"
        height: 10
        view_layout:
          grid-column: span 6
